<!DOCTYPE html>

<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>حاسبة جرعات التبخير</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 10px;
        line-height: 1.6;
    }
    
    .container {
        max-width: 600px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        overflow: hidden;
    }
    
    .header {
        background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
        color: white;
        padding: 25px;
        text-align: center;
    }
    
    .header h1 {
        font-size: 1.8em;
        margin-bottom: 5px;
    }
    
    .header p {
        opacity: 0.9;
        font-size: 0.9em;
    }
    
    .content {
        padding: 20px;
    }
    
    .form-section {
        margin-bottom: 25px;
    }
    
    .form-section h3 {
        color: #2c3e50;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 2px solid #3498db;
        font-size: 1.2em;
    }
    
    .form-group {
        margin-bottom: 15px;
    }
    
    .form-group label {
        display: block;
        margin-bottom: 5px;
        color: #2c3e50;
        font-weight: 600;
    }
    
    .form-group input,
    .form-group select {
        width: 100%;
        padding: 12px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        font-size: 16px;
        transition: all 0.3s;
    }
    
    .form-group input:focus,
    .form-group select:focus {
        outline: none;
        border-color: #3498db;
        box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
    }
    
    .checkbox-group {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px;
        background: #f8f9fa;
        border-radius: 8px;
        margin-bottom: 10px;
    }
    
    .checkbox-group input[type="checkbox"] {
        width: 20px;
        height: 20px;
        cursor: pointer;
    }
    
    .checkbox-group label {
        margin: 0;
        cursor: pointer;
    }
    
    .btn {
        width: 100%;
        padding: 15px;
        background: linear-gradient(135deg, #3498db, #2980b9);
        color: white;
        border: none;
        border-radius: 10px;
        font-size: 1.1em;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s;
        margin-top: 10px;
    }
    
    .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
    }
    
    .btn:active {
        transform: translateY(0);
    }
    
    .btn-secondary {
        background: linear-gradient(135deg, #95a5a6, #7f8c8d);
    }
    
    .btn-success {
        background: linear-gradient(135deg, #27ae60, #229954);
    }
    
    .results {
        display: none;
        margin-top: 20px;
    }
    
    .result-card {
        background: #f8f9fa;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 20px;
        border-right: 5px solid #3498db;
    }
    
    .result-card h3 {
        color: #2c3e50;
        margin-bottom: 15px;
        font-size: 1.3em;
    }
    
    .dose-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px;
        background: white;
        border-radius: 8px;
        margin-bottom: 10px;
    }
    
    .dose-name {
        font-weight: 600;
        color: #2c3e50;
    }
    
    .dose-value {
        background: #3498db;
        color: white;
        padding: 5px 15px;
        border-radius: 20px;
        font-weight: bold;
    }
    
    .warning-box {
        background: #fff3cd;
        border: 2px solid #ffc107;
        border-radius: 12px;
        padding: 15px;
        margin-top: 20px;
    }
    
    .warning-box h4 {
        color: #856404;
        margin-bottom: 10px;
    }
    
    .warning-item {
        padding: 8px;
        margin-bottom: 5px;
        background: white;
        border-radius: 6px;
        border-right: 3px solid #ffc107;
    }
    
    .schedule-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
        background: white;
        border-radius: 8px;
        overflow: hidden;
    }
    
    .schedule-table th {
        background: #34495e;
        color: white;
        padding: 12px;
        text-align: right;
    }
    
    .schedule-table td {
        padding: 12px;
        border-bottom: 1px solid #e0e0e0;
    }
    
    .schedule-table tr:last-child td {
        border-bottom: none;
    }
    
    .share-buttons {
        display: flex;
        gap: 10px;
        margin-top: 20px;
    }
    
    .share-buttons button {
        flex: 1;
    }
    
    .hidden {
        display: none;
    }
    
    @media print {
        body {
            background: white;
        }
        .btn, .share-buttons {
            display: none;
        }
    }
</style>
```

</head>
<body>
    <div class="container">
        <div class="header">
            <h1>💊 حاسبة جرعات التبخير</h1>
            <p>احسب الجرعات المناسبة بدقة وأمان</p>
        </div>

```
    <div class="content">
        <div id="inputForm">
            <div class="form-section">
                <h3>📋 معلومات المريض</h3>
                
                <div class="form-group">
                    <label for="name">الاسم:</label>
                    <input type="text" id="name" placeholder="أدخل الاسم">
                </div>
                
                <div class="form-group">
                    <label for="age">العمر (سنوات):</label>
                    <input type="number" id="age" min="0" max="120" placeholder="مثال: 35">
                </div>
                
                <div class="form-group">
                    <label for="weight">الوزن (كجم):</label>
                    <input type="number" id="weight" min="1" max="500" step="0.1" placeholder="مثال: 75">
                </div>
                
                <div class="form-group">
                    <label for="height">الطول (سم):</label>
                    <input type="number" id="height" min="50" max="250" placeholder="مثال: 170">
                </div>
            </div>
            
            <div class="form-section">
                <h3>🏥 الأمراض المصاحبة</h3>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="diabetes">
                    <label for="diabetes">مرض السكري</label>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="hypertension">
                    <label for="hypertension">ضغط الدم</label>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="heart">
                    <label for="heart">أمراض القلب</label>
                </div>
            </div>
            
            <div class="form-section">
                <h3>⚕️ شدة الحالة</h3>
                
                <div class="form-group">
                    <select id="severity">
                        <option value="1">خفيفة - أعراض بسيطة</option>
                        <option value="2" selected>متوسطة - ضيق ملحوظ</option>
                        <option value="3">شديدة - ضيق حاد</option>
                    </select>
                </div>
            </div>
            
            <button class="btn" onclick="calculateDoses()">احسب الجرعات</button>
        </div>
        
        <div id="results" class="results">
            <div class="result-card">
                <h3>👤 ملخص الحالة</h3>
                <div id="patientSummary"></div>
            </div>
            
            <div class="result-card">
                <h3>💊 بروتوكول العلاج</h3>
                <p><strong>شدة الحالة:</strong> <span id="severityText"></span></p>
                <p><strong>التكرار:</strong> <span id="frequency"></span></p>
                
                <h4 style="margin-top: 20px; margin-bottom: 10px;">الجلسة الأولى - الموسعات:</h4>
                <div id="session1"></div>
                
                <h4 style="margin-top: 20px; margin-bottom: 10px;">الجلسة الثانية - الكورتيزون (بعد 15 دقيقة):</h4>
                <div id="session2"></div>
                <p style="margin-top: 15px; padding: 10px; background: #e74c3c; color: white; border-radius: 8px; text-align: center;">
                    <strong>⚠️ لا تنسَ المضمضة بعد الجلسة الثانية!</strong>
                </p>
            </div>
            
            <div class="result-card">
                <h3>📅 الجدول اليومي</h3>
                <table class="schedule-table">
                    <thead>
                        <tr>
                            <th>الوقت</th>
                            <th>الجلسة</th>
                        </tr>
                    </thead>
                    <tbody id="scheduleTable"></tbody>
                </table>
            </div>
            
            <div class="warning-box" id="warningsBox">
                <h4>⚠️ تحذيرات مهمة</h4>
                <div id="warningsList"></div>
            </div>
            
            <div class="share-buttons">
                <button class="btn btn-success" onclick="shareResults()">📤 مشاركة النتائج</button>
                <button class="btn btn-secondary" onclick="printResults()">🖨️ طباعة</button>
                <button class="btn" onclick="resetForm()">🔄 مريض جديد</button>
            </div>
        </div>
    </div>
</div>

<script>
    function calculateDoses() {
        const name = document.getElementById('name').value;
        const age = parseInt(document.getElementById('age').value);
        const weight = parseFloat(document.getElementById('weight').value);
        const height = parseFloat(document.getElementById('height').value);
        const diabetes = document.getElementById('diabetes').checked;
        const hypertension = document.getElementById('hypertension').checked;
        const heart = document.getElementById('heart').checked;
        const severity = parseInt(document.getElementById('severity').value);
        
        if (!name || !age || !weight || !height) {
            alert('الرجاء إدخال جميع البيانات المطلوبة');
            return;
        }
        
        let ventolin = 0.5;
        let atrovent = 2.0;
        let pulmicort = 2.0;
        
        if (age < 2) {
            ventolin *= 0.25;
            atrovent *= 0.5;
            pulmicort *= 0.5;
        } else if (age < 6) {
            ventolin *= 0.5;
            atrovent *= 0.75;
            pulmicort *= 0.75;
        } else if (age < 12) {
            ventolin *= 0.75;
            atrovent *= 0.85;
            pulmicort *= 0.85;
        } else if (age < 18) {
            ventolin *= 0.9;
            atrovent *= 0.9;
            pulmicort *= 0.9;
        }
        
        if (age >= 18 && weight > 100) {
            const factor = Math.min(1.3, 1 + (weight - 100) / 200);
            ventolin *= factor;
        }
        
        let freq = '';
        if (severity === 1) {
            ventolin = Math.round(ventolin * 100) / 100;
            pulmicort = Math.round(pulmicort * 0.75 * 100) / 100;
            freq = 'مرتين يومياً';
        } else if (severity === 2) {
            ventolin = Math.round(ventolin * 1.2 * 100) / 100;
            pulmicort = Math.round(pulmicort * 100) / 100;
            freq = 'مرتين يومياً';
        } else {
            ventolin = Math.round(ventolin * 2 * 100) / 100;
            pulmicort = Math.round(pulmicort * 1.25 * 100) / 100;
            freq = 'كل 4-6 ساعات حسب الحاجة';
        }
        
        ventolin = Math.min(ventolin, 2.0);
        atrovent = Math.min(Math.round(atrovent * 100) / 100, 2.5);
        pulmicort = Math.min(pulmicort, 4.0);
        
        const saline1 = Math.max(Math.round((5 - ventolin - atrovent) * 100) / 100, 1);
        const saline2 = Math.max(Math.round((4 - pulmicort) * 100) / 100, 1);
        
        const bmi = Math.round((weight / Math.pow(height / 100, 2)) * 10) / 10;
        
        displayResults({
            name, age, weight, height, bmi, diabetes, hypertension, heart, severity,
            ventolin, atrovent, pulmicort, saline1, saline2, freq
        });
    }
    
    function displayResults(data) {
        const severityNames = {1: 'خفيفة', 2: 'متوسطة', 3: 'شديدة'};
        
        document.getElementById('patientSummary').innerHTML = `
            <p><strong>الاسم:</strong> ${data.name}</p>
            <p><strong>العمر:</strong> ${data.age} سنة</p>
            <p><strong>الوزن:</strong> ${data.weight} كجم</p>
            <p><strong>الطول:</strong> ${data.height} سم</p>
            <p><strong>مؤشر كتلة الجسم:</strong> ${data.bmi}</p>
            <p><strong>الأمراض:</strong> ${getConditions(data)}</p>
        `;
        
        document.getElementById('severityText').textContent = severityNames[data.severity];
        document.getElementById('frequency').textContent = data.freq;
        
        document.getElementById('session1').innerHTML = `
            <div class="dose-item">
                <span class="dose-name">فنتولين (5mg/ml)</span>
                <span class="dose-value">${data.ventolin} ml</span>
            </div>
            <div class="dose-item">
                <span class="dose-name">أتروفنت (0.25mg/ml)</span>
                <span class="dose-value">${data.atrovent} ml</span>
            </div>
            <div class="dose-item">
                <span class="dose-name">محلول ملحي</span>
                <span class="dose-value">${data.saline1} ml</span>
            </div>
            <div class="dose-item" style="background: #e8f5e9;">
                <span class="dose-name"><strong>المجموع الكلي</strong></span>
                <span class="dose-value" style="background: #27ae60;">${Math.round((data.ventolin + data.atrovent + data.saline1) * 100) / 100} ml</span>
            </div>
        `;
        
        document.getElementById('session2').innerHTML = `
            <div class="dose-item">
                <span class="dose-name">بلميكورت (0.5mg/ml)</span>
                <span class="dose-value">${data.pulmicort} ml</span>
            </div>
            <div class="dose-item">
                <span class="dose-name">محلول ملحي</span>
                <span class="dose-value">${data.saline2} ml</span>
            </div>
            <div class="dose-item" style="background: #e8f5e9;">
                <span class="dose-name"><strong>المجموع الكلي</strong></span>
                <span class="dose-value" style="background: #27ae60;">${Math.round((data.pulmicort + data.saline2) * 100) / 100} ml</span>
            </div>
        `;
        
        document.getElementById('scheduleTable').innerHTML = `
            <tr>
                <td><strong>8:00 صباحاً</strong></td>
                <td>الجلسة الأولى (فنتولين + أتروفنت + ملحي)</td>
            </tr>
            <tr>
                <td><strong>8:15 صباحاً</strong></td>
                <td>الجلسة الثانية (بلميكورت + ملحي) + مضمضة</td>
            </tr>
            <tr>
                <td><strong>8:00 مساءً</strong></td>
                <td>الجلسة الأولى (فنتولين + أتروفنت + ملحي)</td>
            </tr>
            <tr>
                <td><strong>8:15 مساءً</strong></td>
                <td>الجلسة الثانية (بلميكورت + ملحي) + مضمضة</td>
            </tr>
        `;
        
        displayWarnings(data);
        
        document.getElementById('inputForm').style.display = 'none';
        document.getElementById('results').style.display = 'block';
        window.scrollTo(0, 0);
    }
    
    function getConditions(data) {
        const conditions = [];
        if (data.diabetes) conditions.push('سكري');
        if (data.hypertension) conditions.push('ضغط دم');
        if (data.heart) conditions.push('أمراض قلب');
        return conditions.length > 0 ? conditions.join(', ') : 'لا توجد';
    }
    
    function displayWarnings(data) {
        let warnings = [];
        
        if (data.diabetes) {
            warnings.push('مراقبة السكر: الفنتولين قد يرفع مستوى السكر مؤقتاً');
        }
        if (data.hypertension || data.heart) {
            warnings.push('مراقبة القلب: راقب النبض والضغط بعد كل جلسة');
        }
        if (data.age < 6) {
            warnings.push('للأطفال: يُفضل استشارة طبيب أطفال متخصص');
        }
        if (data.age >= 65) {
            warnings.push('كبار السن: قد يحتاج لجرعات معدلة');
        }
        
        warnings.push('المضمضة إلزامية بعد كل جلسة بلميكورت');
        warnings.push('اجلس بوضعية مستقيمة أثناء الجلسة');
        warnings.push('نظف جهاز التبخير بعد كل استخدام');
        
        document.getElementById('warningsList').innerHTML = warnings.map(w => 
            `<div class="warning-item">• ${w}</div>`
        ).join('');
    }
    
    function shareResults() {
        const name = document.getElementById('name').value;
        const age = document.getElementById('age').value;
        const weight = document.getElementById('weight').value;
        
        const text = `💊 نتائج حاسبة جرعات التبخير\n\n` +
            `👤 المريض: ${name}\n` +
            `📊 العمر: ${age} سنة | الوزن: ${weight} كجم\n\n` +
            `استخدم هذا الرابط لحساب جرعاتك:\n` +
            `[أضف رابط التطبيق هنا]`;
        
        if (navigator.share) {
            navigator.share({
                title: 'حاسبة جرعات التبخير',
                text: text
            });
        } else {
            navigator.clipboard.writeText(text);
            alert('تم نسخ النتائج! يمكنك الآن لصقها في WhatsApp');
        }
    }
    
    function printResults() {
        window.print();
    }
    
    function resetForm() {
        document.getElementById('inputForm').style.display = 'block';
        document.getElementById('results').style.display = 'none';
        window.scrollTo(0, 0);
    }
</script>
```

</body>
</html>